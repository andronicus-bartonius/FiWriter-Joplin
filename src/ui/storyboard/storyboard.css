:root {
	--bg-primary: #1e1e2e;
	--bg-secondary: #313244;
	--bg-tertiary: #45475a;
	--bg-hover: #585b70;
	--bg-surface: #181825;
	--text-primary: #cdd6f4;
	--text-secondary: #a6adc8;
	--text-muted: #6c7086;
	--accent: #89b4fa;
	--accent-hover: #74c7ec;
	--border: #45475a;
	--border-light: #585b70;
	--success: #a6e3a1;
	--warning: #f9e2af;
	--error: #f38ba8;
	--shadow: rgba(0, 0, 0, 0.3);

	--card-character: #f5c2e7;
	--card-location: #89b4fa;
	--card-rule: #f9e2af;
	--card-item: #a6e3a1;
	--card-arc: #cba6f7;
	--card-relationship: #f38ba8;
	--card-beat: #fab387;
	--card-event: #94e2d5;
	--card-thread: #74c7ec;
}

body.light-theme {
	--bg-primary: #eff1f5;
	--bg-secondary: #e6e9ef;
	--bg-tertiary: #ccd0da;
	--bg-hover: #bcc0cc;
	--bg-surface: #dce0e8;
	--text-primary: #4c4f69;
	--text-secondary: #5c5f77;
	--text-muted: #9ca0b0;
	--accent: #1e66f5;
	--accent-hover: #209fb5;
	--border: #ccd0da;
	--border-light: #bcc0cc;
	--success: #40a02b;
	--warning: #df8e1d;
	--error: #d20f39;
	--shadow: rgba(0, 0, 0, 0.1);
}

* { box-sizing: border-box; margin: 0; padding: 0; }

body {
	font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
	font-size: 13px;
	background: var(--bg-primary);
	color: var(--text-primary);
	line-height: 1.5;
	overflow: hidden;
	height: 100vh;
}

/* ---- Layout ---- */
.storyboard-app {
	display: flex;
	flex-direction: column;
	height: 100vh;
}

/* ---- Toolbar ---- */
.sb-toolbar {
	display: flex;
	align-items: center;
	gap: 8px;
	padding: 8px 12px;
	background: var(--bg-secondary);
	border-bottom: 1px solid var(--border);
	flex-shrink: 0;
}

.sb-toolbar-left {
	display: flex;
	align-items: center;
	gap: 8px;
	flex: 1;
}

.sb-toolbar-right {
	display: flex;
	align-items: center;
	gap: 6px;
}

/* ---- Scope breadcrumb ---- */
.scope-breadcrumb {
	display: flex;
	align-items: center;
	gap: 4px;
	font-size: 12px;
}

.scope-crumb {
	padding: 2px 8px;
	border-radius: 4px;
	background: var(--bg-tertiary);
	color: var(--text-secondary);
	cursor: pointer;
	border: none;
	font-size: 12px;
	transition: background 0.15s;
}

.scope-crumb:hover { background: var(--bg-hover); }
.scope-crumb.active { background: var(--accent); color: var(--bg-primary); font-weight: 600; }

.scope-separator { color: var(--text-muted); }

/* ---- Search/filter bar ---- */
.sb-search {
	display: flex;
	align-items: center;
	gap: 6px;
}

.sb-search input {
	background: var(--bg-tertiary);
	border: 1px solid var(--border);
	border-radius: 4px;
	padding: 4px 8px;
	color: var(--text-primary);
	font-size: 12px;
	width: 180px;
	outline: none;
}

.sb-search input:focus {
	border-color: var(--accent);
}

.sb-filter-btn {
	padding: 4px 8px;
	border: 1px solid var(--border);
	border-radius: 4px;
	background: var(--bg-tertiary);
	color: var(--text-secondary);
	font-size: 11px;
	cursor: pointer;
	transition: all 0.15s;
}

.sb-filter-btn:hover { background: var(--bg-hover); }
.sb-filter-btn.active { background: var(--accent); color: var(--bg-primary); border-color: var(--accent); }

/* ---- Main content area ---- */
.sb-content {
	display: flex;
	flex: 1;
	overflow: hidden;
}

/* ---- Board canvas ---- */
.sb-board {
	flex: 1;
	padding: 16px;
	overflow-y: auto;
	overflow-x: hidden;
}

.sb-board-grid {
	display: grid;
	grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
	gap: 12px;
	align-content: start;
}

.sb-board-empty {
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	height: 100%;
	color: var(--text-muted);
	font-size: 14px;
	gap: 12px;
}

/* ---- Entity card ---- */
.entity-card {
	background: var(--bg-secondary);
	border: 1px solid var(--border);
	border-radius: 8px;
	padding: 10px;
	cursor: pointer;
	transition: all 0.15s;
	position: relative;
	border-left: 3px solid var(--border);
}

.entity-card:hover {
	background: var(--bg-tertiary);
	box-shadow: 0 2px 8px var(--shadow);
}

.entity-card.selected {
	border-color: var(--accent);
	box-shadow: 0 0 0 1px var(--accent);
}

.entity-card.dragging {
	opacity: 0.5;
	transform: rotate(2deg);
}

.entity-card[data-type="Character"] { border-left-color: var(--card-character); }
.entity-card[data-type="Location"]  { border-left-color: var(--card-location); }
.entity-card[data-type="Rule"]      { border-left-color: var(--card-rule); }
.entity-card[data-type="Item"]      { border-left-color: var(--card-item); }
.entity-card[data-type="Arc"]       { border-left-color: var(--card-arc); }
.entity-card[data-type="Relationship"] { border-left-color: var(--card-relationship); }
.entity-card[data-type="Beat"]      { border-left-color: var(--card-beat); }
.entity-card[data-type="Event"]     { border-left-color: var(--card-event); }
.entity-card[data-type="Thread"]    { border-left-color: var(--card-thread); }

.card-header {
	display: flex;
	align-items: center;
	gap: 6px;
	margin-bottom: 6px;
}

.card-type-badge {
	font-size: 9px;
	font-weight: 700;
	text-transform: uppercase;
	padding: 1px 5px;
	border-radius: 3px;
	color: var(--bg-primary);
	flex-shrink: 0;
}

.card-type-badge.Character { background: var(--card-character); }
.card-type-badge.Location  { background: var(--card-location); }
.card-type-badge.Rule      { background: var(--card-rule); }
.card-type-badge.Item      { background: var(--card-item); }
.card-type-badge.Arc       { background: var(--card-arc); }
.card-type-badge.Relationship { background: var(--card-relationship); }
.card-type-badge.Beat      { background: var(--card-beat); }
.card-type-badge.Event     { background: var(--card-event); }
.card-type-badge.Thread    { background: var(--card-thread); }

.card-name {
	font-size: 12px;
	font-weight: 600;
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
	flex: 1;
}

.card-status {
	font-size: 9px;
	padding: 1px 4px;
	border-radius: 3px;
	text-transform: uppercase;
}

.card-status.canon { background: var(--success); color: var(--bg-primary); }
.card-status.draft { background: var(--text-muted); color: var(--bg-primary); }
.card-status.needs-review { background: var(--warning); color: var(--bg-primary); }
.card-status.archived { background: var(--border); color: var(--text-muted); }

.card-excerpt {
	font-size: 11px;
	color: var(--text-secondary);
	line-height: 1.4;
	max-height: 3.6em;
	overflow: hidden;
	word-break: break-word;
}

.card-tags {
	display: flex;
	gap: 4px;
	margin-top: 6px;
	flex-wrap: wrap;
}

.card-tag {
	font-size: 9px;
	padding: 1px 4px;
	border-radius: 2px;
	background: var(--bg-tertiary);
	color: var(--text-muted);
}

/* ---- Inspector panel ---- */
.sb-inspector {
	width: 320px;
	background: var(--bg-surface);
	border-left: 1px solid var(--border);
	display: flex;
	flex-direction: column;
	overflow-y: auto;
	flex-shrink: 0;
}

.sb-inspector.hidden { display: none; }

.inspector-header {
	display: flex;
	align-items: center;
	justify-content: space-between;
	padding: 10px 12px;
	border-bottom: 1px solid var(--border);
}

.inspector-header h3 {
	font-size: 13px;
	font-weight: 600;
}

.inspector-close {
	background: none;
	border: none;
	color: var(--text-muted);
	cursor: pointer;
	font-size: 16px;
	padding: 2px;
}

.inspector-close:hover { color: var(--text-primary); }

.inspector-body {
	padding: 12px;
	display: flex;
	flex-direction: column;
	gap: 12px;
}

.inspector-field {
	display: flex;
	flex-direction: column;
	gap: 4px;
}

.inspector-field label {
	font-size: 10px;
	font-weight: 700;
	text-transform: uppercase;
	letter-spacing: 0.5px;
	color: var(--text-muted);
}

.inspector-field input,
.inspector-field textarea,
.inspector-field select {
	background: var(--bg-tertiary);
	border: 1px solid var(--border);
	border-radius: 4px;
	padding: 6px 8px;
	color: var(--text-primary);
	font-size: 12px;
	font-family: inherit;
	outline: none;
	resize: vertical;
}

.inspector-field input:focus,
.inspector-field textarea:focus,
.inspector-field select:focus {
	border-color: var(--accent);
}

.inspector-field textarea {
	min-height: 80px;
}

.inspector-actions {
	display: flex;
	gap: 6px;
	padding: 12px;
	border-top: 1px solid var(--border);
}

/* ---- Buttons ---- */
.btn {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	gap: 4px;
	padding: 6px 12px;
	border: none;
	border-radius: 6px;
	font-size: 12px;
	cursor: pointer;
	transition: background 0.15s;
	font-family: inherit;
}

.btn-primary { background: var(--accent); color: var(--bg-primary); font-weight: 600; }
.btn-primary:hover { background: var(--accent-hover); }

.btn-secondary { background: var(--bg-tertiary); color: var(--text-primary); }
.btn-secondary:hover { background: var(--bg-hover); }

.btn-danger { background: var(--error); color: var(--bg-primary); }
.btn-danger:hover { opacity: 0.85; }

.btn-sm { padding: 4px 8px; font-size: 11px; }
.btn-icon { padding: 4px 6px; min-width: unset; }

/* ---- Scrollbar ---- */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }
